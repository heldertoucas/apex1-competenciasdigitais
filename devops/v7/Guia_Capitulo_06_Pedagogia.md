# Manual de Implementação - Capítulo 6: Execução Pedagógica
**Aplicação:** Academia Digital  
**Versão do Guia:** 1.0  
**Objetivo:** Ferramentas do dia-a-dia do Formador (Sala de Aula).

---

## 1. Dados Pedagógicos (SQL)

Tabelas para registar o que acontece na sala.

### 1.1. Script Pedagogia
1.  **Script Name:** `06_Pedagogia`.
2.  Código:

```sql
-- CAPÍTULO 6: PEDAGOGIA

-- 1. Presenças (Assiduidade por Sessão)
CREATE TABLE Presencas (
    ID_Presenca NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ID_Sessao NUMBER NOT NULL,
    ID_Matricula NUMBER NOT NULL,
    ID_Estado_Presenca NUMBER, -- FK
    Horas_Assistidas NUMBER,
    Data_Registo TIMESTAMP DEFAULT SYSTIMESTAMP,
    FOREIGN KEY (ID_Sessao) REFERENCES Sessoes(ID_Sessao),
    FOREIGN KEY (ID_Matricula) REFERENCES Matriculas(ID_Matricula)
);

-- 2. Avaliações (Notas por Módulo)
CREATE TABLE Avaliacoes_Modulo (
    ID_Avaliacao NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ID_Matricula NUMBER NOT NULL,
    ID_Modulo NUMBER NOT NULL,
    Nota_Valor NUMBER,
    Feedback_Texto CLOB,
    Aprovado CHAR(1),
    FOREIGN KEY (ID_Matricula) REFERENCES Matriculas(ID_Matricula),
    FOREIGN KEY (ID_Modulo) REFERENCES Modulos(ID_Modulo)
);

-- 3. Badges (Conquistas)
CREATE TABLE Badges_Conquistados (
    ID_Badge_Aluno NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ID_Matricula NUMBER NOT NULL,
    ID_Competencia NUMBER NOT NULL,
    Data_Conquista DATE DEFAULT SYSDATE,
    URL_Evidencia VARCHAR2(500),
    FOREIGN KEY (ID_Matricula) REFERENCES Matriculas(ID_Matricula),
    FOREIGN KEY (ID_Competencia) REFERENCES Competencias(ID_Competencia)
);
```
3.  **Executar.**

---

## 2. O Portal do Formador (UI)

Uma área simplificada para o formador, idealmente optimizada para Tablets.

### 2.1. Dashboard "Minhas Turmas"
1.  **Create Page** > **Component**.
2.  **Cards**.
3.  **Page Name:** `Minhas Turmas`.
4.  **Table:** `TURMAS` (com SQL Query customizada depois).
4.  **Where Clause:** `ID_Formador = :APP_USER_ENTIDADE_ID`
    *   *Nota Importante:* Isto requer que tenha criado lógica de Login para associar o utilizador APEX a um ID na tabela Entidades, guardando-o num Item de Aplicação (Application Item).
    *   *Para Testar Agora:* Se ainda não tem login customizado, comente esta cláusula WHERE para ver todas as turmas (`-- ID_Formador = ...`).
5.  **Card Actions:** Link para o "Diário de Aulas".

### 2.2. Diário de Aulas (Gestão de Presenças)
1.  **Create Page** > **Form**.
2.  **Form**.
3.  **Page Name:** `Diário da Aula`.
4.  **Table:** `SESSOES`.
2.  **Adicionar Região IG (Presenças):**
    *   Dentro da página da sessão, adicione um Interactive Grid na tabela `Presencas`.
    *   Filtro: `ID_Sessao = :P_ID_SESSAO`.
3.  **Botão "Gerar Lista de Turma":**
    *   Crie um botão **"Gerar Lista"** na região ou na posição "Right of Interactive Grid".
    *   Crie um Processo (Processing) que corre ao clicar (Submit):
    *   **PL/SQL Code:**
        ```sql
        BEGIN
            -- Insere uma linha de presença para cada aluno matriculado na turma, se ainda não existir para esta sessão
            INSERT INTO Presencas (ID_Sessao, ID_Matricula, Horas_Assistidas, ID_Estado_Presenca)
            SELECT :P50_ID_SESSAO, m.ID_Matricula, 0, NULL -- NULL ou ID default
            FROM Matriculas m
            WHERE m.ID_Turma = (SELECT ID_Turma FROM Sessoes WHERE ID_Sessao = :P50_ID_SESSAO)
              AND m.ID_Estado_Matricula IN (SELECT ID_Estado_Matricula FROM Tipos_Estado_Matricula WHERE Codigo = 'FREQUENTAR') -- Apenas ativos
              AND NOT EXISTS (SELECT 1 FROM Presencas p WHERE p.ID_Matricula = m.ID_Matricula AND p.ID_Sessao = :P50_ID_SESSAO);
        END;
        ```
    *   *Nota:* O formador depois só edita a grelha para mudar para "Presente" ou "Falta".

### 2.3. Lançamento de Notas
1.  **Create Page** > **Master-Detail**.
2.  **Stacked** (Empilhado).
3.  **Page Name:** `Lançamento de Notas`.
4.  **Master Table:** `TURMAS`.
5.  **Detail Table:** `AVALIACOES_MODULO`.

---
**Conclusão Capítulo 6:**
O sistema suporta agora o registo do "coração" da formação: aulas, faltas e notas.
